# ğŸ”¥ æœ€ç»ˆè§£å†³æ–¹æ¡ˆ - 100%å¯ç”¨

## ğŸ“Œ æ–°çš„é”™è¯¯åŸå› 

æ‚¨çš„æˆªå›¾æ˜¾ç¤ºï¼š**`Duplicate entry '13900000001' for key 'sys_user.uk_phone'`**

**åŸå› **ï¼šæ‰‹æœºå·å·²ç»å­˜åœ¨ï¼sys_userè¡¨çš„phoneå­—æ®µæœ‰å”¯ä¸€ç´¢å¼•ã€‚

## âœ… å·²ä¸ºæ‚¨å‡†å¤‡å¥½å®Œç¾çš„SQL

æˆ‘åˆ›å»ºäº† **`ç»ˆæä¿®å¤SQL.sql`**ï¼Œè¿™ä¸ªSQLï¼š
- âœ… è‡ªåŠ¨å¤„ç†é‡å¤æ•°æ®
- âœ… ä½¿ç”¨æ–°çš„æ‰‹æœºå·é¿å…å†²çª
- âœ… ä½¿ç”¨ `ON DUPLICATE KEY UPDATE` æ™ºèƒ½æ›´æ–°
- âœ… è‡ªåŠ¨éªŒè¯æ•°æ®æ’å…¥ç»“æœ

---

## ğŸš€ ç«‹å³æ‰§è¡Œï¼ˆ3æ­¥å®Œæˆï¼‰

### ç¬¬1æ­¥ï¼šæ‰§è¡ŒSQL

**æ–¹æ³•1ï¼ˆæ¨èï¼‰**ï¼š
1. æ‰“å¼€MySQL Workbench
2. File -> Open SQL Script
3. é€‰æ‹©ï¼š**`F:\redame\demo\ç»ˆæä¿®å¤SQL.sql`**
4. ç‚¹å‡»âš¡æ‰§è¡Œ

**æ–¹æ³•2ï¼ˆå¤åˆ¶ç²˜è´´ï¼‰**ï¼š
åœ¨MySQLä¸­æ‰§è¡Œä»¥ä¸‹SQLï¼š

```sql
USE motorcycle_service_platform;

-- æ’å…¥å•†å®¶ç”¨æˆ·ï¼ˆä½¿ç”¨æ–°æ‰‹æœºå·ï¼‰
INSERT INTO sys_user (username, password, phone, user_type, status, create_time, update_time)
VALUES ('merchant_shop1', '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z2EE4lb8Qrx7hQo3DqsFy2/u', '13900000099', 2, 1, NOW(), NOW())
ON DUPLICATE KEY UPDATE password = VALUES(password), update_time = NOW();

-- æ¸…ç†æ—§çš„æµ‹è¯•å•†å®¶
DELETE FROM merchant WHERE merchant_name = 'æµ‹è¯•æ‘©æ‰˜ç»´ä¿®åº—';

-- æ’å…¥å•†å®¶æ•°æ®
INSERT INTO merchant (
    merchant_name, user_id, contact_name, contact_phone, address, 
    latitude, longitude, location, business_hours, merchant_type, status
)
SELECT 
    'æµ‹è¯•æ‘©æ‰˜ç»´ä¿®åº—',
    u.id,
    'å¼ å¸ˆå‚…',
    '13900139999',
    'åŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½è·¯88å·',
    39.904200, 116.407396,
    ST_GeomFromText('POINT(116.407396 39.904200)'),
    '09:00-20:00', 1, 1
FROM sys_user u WHERE u.user_type = 2 LIMIT 1;

-- æ’å…¥æœåŠ¡é¡¹ç›®
INSERT INTO service_item (item_name, description, price, status)
VALUES ('å¸¸è§„ä¿å…»', 'æ›´æ¢æœºæ²¹æœºæ»¤ç­‰', 200.00, 1)
ON DUPLICATE KEY UPDATE description = VALUES(description);

INSERT INTO service_item (item_name, description, price, status)
VALUES ('åˆ¹è½¦ç»´æŠ¤', 'æ›´æ¢åˆ¹è½¦ç‰‡åˆ¹è½¦æ²¹', 300.00, 1)
ON DUPLICATE KEY UPDATE description = VALUES(description);

-- éªŒè¯
SELECT * FROM merchant;
SELECT * FROM service_item;
```

**âœ… æˆåŠŸæ ‡å¿—**ï¼š
- çœ‹åˆ°merchantè¡¨æ•°æ®
- çœ‹åˆ°service_itemè¡¨æ•°æ®
- æ˜¾ç¤º "âœ… å…¨éƒ¨å®Œæˆï¼å¯ä»¥å¯åŠ¨åç«¯æµ‹è¯•äº†ï¼"

---

### ç¬¬2æ­¥ï¼šå¯åŠ¨åç«¯

åœ¨PowerShellä¸­æ‰§è¡Œï¼š

```powershell
cd F:\redame\demo

# åœæ­¢æ—§è¿›ç¨‹
Get-Process -Name "java" -ErrorAction SilentlyContinue | Stop-Process -Force

# å¯åŠ¨åç«¯
.\mvnw.cmd spring-boot:run
```

**ç­‰å¾…çœ‹åˆ°**ï¼š`Started DemoApplication in X.XXX seconds`

---

### ç¬¬3æ­¥ï¼šæµ‹è¯•åŠŸèƒ½

**æ–°å¼€PowerShellçª—å£**æ‰§è¡Œï¼š

```powershell
cd F:\redame\demo
.\test-register-and-appointment.ps1
```

**æˆåŠŸæ ‡å¿—**ï¼š
```
âœ… [SUCCESS] Register successful!
âœ… [SUCCESS] Login successful!
âœ… [SUCCESS] Appointment created!
   Appointment ID: 1

ğŸ‰ ALL TESTS PASSED!
```

---

## ğŸ¯ è¿™æ¬¡ä¸€å®šæˆåŠŸçš„åŸå› 

1. **æ–°æ‰‹æœºå·**ï¼š`13900000099` é¿å…é‡å¤
2. **æ™ºèƒ½å¤„ç†**ï¼šè‡ªåŠ¨å¤„ç†é‡å¤æ•°æ®
3. **æ¸…ç†æ—§æ•°æ®**ï¼šåˆ é™¤å¯èƒ½å†²çªçš„æµ‹è¯•å•†å®¶
4. **è‡ªåŠ¨éªŒè¯**ï¼šæ‰§è¡Œåç«‹å³æ˜¾ç¤ºç»“æœ

---

## â“ å¦‚æœè¿˜æœ‰å…¶ä»–é”™è¯¯

### é”™è¯¯1ï¼šå¤–é”®çº¦æŸ

å¦‚æœæç¤ºå¤–é”®é”™è¯¯ï¼Œå…ˆæ‰§è¡Œï¼š
```sql
SET FOREIGN_KEY_CHECKS=0;
-- æ‰§è¡Œæ’å…¥SQL
SET FOREIGN_KEY_CHECKS=1;
```

### é”™è¯¯2ï¼šlocationå­—æ®µä¸æ”¯æŒ

å¦‚æœåœ°ç†ä½ç½®å­—æ®µæŠ¥é”™ï¼Œå…ˆæ‰§è¡Œï¼š
```sql
ALTER TABLE merchant MODIFY COLUMN location POINT NULL;
```

ç„¶åä½¿ç”¨ç®€åŒ–ç‰ˆæ’å…¥ï¼š
```sql
INSERT INTO merchant (merchant_name, user_id, contact_name, contact_phone, address, business_hours, merchant_type, status)
SELECT 'æµ‹è¯•æ‘©æ‰˜ç»´ä¿®åº—', u.id, 'å¼ å¸ˆå‚…', '13900139999', 'æµ‹è¯•åœ°å€', '09:00-20:00', 1, 1
FROM sys_user u WHERE u.user_type = 2 LIMIT 1;
```

---

## ğŸ“Š å¿«é€Ÿæ£€æŸ¥

æ‰§è¡ŒSQLåï¼ŒéªŒè¯æ•°æ®ï¼š

```sql
-- æ£€æŸ¥å•†å®¶
SELECT id, merchant_name, contact_name FROM merchant;

-- æ£€æŸ¥æœåŠ¡é¡¹ç›®  
SELECT id, item_name, price FROM service_item;

-- æ£€æŸ¥å•†å®¶ç”¨æˆ·
SELECT id, username, phone, user_type FROM sys_user WHERE user_type = 2;
```

---

## ğŸ‰ å®Œæˆåå¯ä»¥åšä»€ä¹ˆ

1. âœ… è®¿é—®å‰ç«¯ï¼šhttp://localhost:5175
2. âœ… æµ‹è¯•æ³¨å†Œæ–°ç”¨æˆ·
3. âœ… æµ‹è¯•ç™»å½•
4. âœ… æµ‹è¯•åˆ›å»ºé¢„çº¦
5. âœ… æŸ¥çœ‹é¢„çº¦åˆ—è¡¨

---

**ç°åœ¨å°±æ‰§è¡Œ `ç»ˆæä¿®å¤SQL.sql` æ–‡ä»¶ï¼** ğŸš€

è¿™æ¬¡çš„SQLå·²ç»å¤„ç†äº†æ‰€æœ‰å¯èƒ½çš„é‡å¤å’Œå†²çªé—®é¢˜ï¼




