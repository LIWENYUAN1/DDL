# 🔍 预约问题诊断指南

## 📋 需要您提供的信息

为了快速定位问题，请提供以下信息：

### 1. 前端错误信息 ⭐⭐⭐
**最重要！** 请打开浏览器的开发者工具查看错误：

#### 如何查看：
1. 在浏览器中按 `F12` 打开开发者工具
2. 切换到 **Console（控制台）** 标签
3. 尝试进行预约操作
4. 查看是否有红色的错误信息
5. **把错误信息复制给我**

常见错误类型：
- ❌ `404 Not Found` - 接口不存在
- ❌ `403 Forbidden` - 没有权限
- ❌ `500 Internal Server Error` - 后端报错
- ❌ `Network Error` - 网络连接失败

---

### 2. 后端运行状态 ⭐⭐
请确认：
- ✅ 后端是否在IDEA中正常运行？
- ✅ IDEA的Run窗口是否有错误信息？
- ✅ 访问 http://localhost:8080/actuator/health 是否显示 `{"status":"UP"}`？

---

### 3. 数据库数据 ⭐
请确认是否已在Navicat中插入测试数据：
- ✅ `merchant` 表是否有商家数据？
- ✅ `service_item` 表是否有服务项目数据？

---

### 4. 预约操作步骤
请告诉我：
1. 您是否已经成功登录？
2. 登录的用户类型是什么？（普通用户/商家/管理员）
3. 预约页面是否能正常显示？
4. 点击提交预约后的具体现象是什么？
   - 是报错？
   - 是没反应？
   - 还是其他情况？

---

## 🚀 快速诊断步骤

### 第1步：检查后端是否正常运行

打开浏览器访问：
```
http://localhost:8080/actuator/health
```

**预期结果**：
```json
{"status":"UP"}
```

**如果无法访问**：
- 说明后端没有运行
- 请在IDEA中启动 `DemoApplication`

---

### 第2步：检查是否已登录

在浏览器开发者工具中：
1. 按 `F12` 打开开发者工具
2. 切换到 **Application（应用）** 标签
3. 左侧找到 **Local Storage**
4. 点击 `http://localhost:5175`
5. 查看是否有 `token` 和 `userInfo`

**如果没有**：
- 说明未登录或登录失败
- 请先登录

---

### 第3步：检查数据库数据

在Navicat中执行：
```sql
-- 查看商家数据
SELECT * FROM merchant;

-- 查看服务项目
SELECT * FROM service_item;
```

**预期结果**：
- `merchant` 表应该有至少2条记录
- `service_item` 表应该有至少4条记录

**如果没有数据**：
- 请执行 `📘Navicat操作指南.md` 中的SQL插入测试数据

---

### 第4步：查看网络请求详情

在浏览器中：
1. 按 `F12` 打开开发者工具
2. 切换到 **Network（网络）** 标签
3. 尝试进行预约操作
4. 查看最新的网络请求
5. 点击该请求查看：
   - **Headers（请求头）**：是否有 `Authorization` token？
   - **Payload/Request（请求体）**：发送的数据是什么？
   - **Response（响应）**：返回的错误信息是什么？

---

## 🎯 常见问题和解决方案

### 问题1：403 Forbidden（最常见）

**症状**：
- 控制台显示 `403 Forbidden`
- 提示"没有权限"

**原因**：
- Token无效或过期
- 未登录

**解决**：
```javascript
// 在浏览器控制台执行，清除旧token
localStorage.clear()
// 然后重新登录
```

---

### 问题2：404 Not Found

**症状**：
- 控制台显示 `404 Not Found`
- 接口路径不存在

**原因**：
- 接口路径配置错误
- 后端未启动

**解决**：
1. 确认后端已启动
2. 检查接口路径是否正确：
   - 应该是 `/api/appointment/create`
   - 不是 `/appointment/create`

---

### 问题3：500 Internal Server Error

**症状**：
- 控制台显示 `500 Internal Server Error`
- 后端报错

**原因**：
- 数据库连接失败
- 后端代码异常
- 缺少必要数据

**解决**：
1. 查看IDEA的Run窗口，找到错误堆栈
2. 把错误信息发给我

---

### 问题4：Network Error

**症状**：
- 控制台显示 `Network Error`
- 无法连接后端

**原因**：
- 后端未启动
- 端口错误
- CORS配置问题

**解决**：
1. 确认后端在8080端口运行
2. 确认前端配置的baseURL是 `http://localhost:8080`

---

### 问题5：缺少商家或服务数据

**症状**：
- 预约页面没有商家可选
- 没有服务项目

**原因**：
- 数据库中没有测试数据

**解决**：
在Navicat中执行：
```sql
USE motorcycle_service_platform;

DELETE FROM service_item WHERE merchant_id > 1;
DELETE FROM merchant WHERE id > 1;

INSERT INTO merchant (merchant_name, user_id, contact_name, contact_phone, address, latitude, longitude, location, business_hours, merchant_type, status)
VALUES ('DDL测试维修店', 5, '李师傅', '13008620788', '北京市朝阳区建国路99号', 39.904200, 116.407396, ST_GeomFromText('POINT(116.407396 39.904200)'), '08:00-21:00', 1, 1);

SET @m = LAST_INSERT_ID();

INSERT INTO service_item (merchant_id, category_id, item_name, price, duration, description, status)
VALUES 
(@m, 6, '常规保养套餐', 200.00, 60, '包含更换机油、机滤、空滤', 1),
(@m, 8, '刹车系统维护', 300.00, 90, '检查更换刹车片刹车油', 1),
(1, 6, '机油更换服务', 180.00, 30, '使用优质机油', 1),
(1, 8, '刹车保养', 280.00, 60, '全面检查刹车系统', 1);
```

---

## 📸 请提供以下截图

1. **浏览器Console控制台** - 显示错误信息
2. **浏览器Network网络标签** - 显示请求详情
3. **IDEA Run窗口** - 如果后端有报错

---

## 🆘 立即行动

### 现在请按顺序做：

1. ✅ **打开浏览器，按F12**
2. ✅ **切换到Console标签**
3. ✅ **尝试预约，查看错误**
4. ✅ **把错误信息发给我**

---

我会根据您提供的错误信息，立即帮您解决问题！🚀



