# 🔍 查看后端详细日志 - 定位5001错误

## ❌ 当前问题

注册请求返回：
```json
{
  "code": 5001,
  "msg": "系统错误" (乱码显示)
}
```

## 📋 查看详细错误步骤

### 方法 1: 查看后台窗口（推荐）

1. **找到后台窗口**
   - 按 `Alt + Tab` 切换窗口
   - 找到标题为 `Windows PowerShell` 或 `mvnw.cmd spring-boot:run` 的窗口
   - 这个窗口显示实时的后端日志

2. **查找错误信息**
   - 在后台窗口中，向上滚动查找红色的 `ERROR` 或 `Exception` 字样
   - 特别注意包含 `register` 或 `SysUser` 的错误行
   - 复制完整的错误堆栈信息

3. **关键信息位置**
   ```
   错误通常在这些位置：
   - Caused by: xxxException
   - java.sql.SQLException
   - org.mybatis.spring.MyBatisSystemException
   ```

### 方法 2: 重新启动并查看日志

```powershell
# 1. 停止当前后端
Get-Process java | Stop-Process -Force

# 2. 启动后端（前台模式，显示所有日志）
cd F:\redame\demo
.\mvnw.cmd spring-boot:run
```

然后在**另一个PowerShell窗口**中测试注册：
```powershell
$body = '{"username":"newuser001","password":"Test123456","confirmPassword":"Test123456","phone":"13900001111","userType":1,"code":"test"}'
Invoke-RestMethod -Uri "http://localhost:8080/auth/register" -Method Post -ContentType "application/json" -Body $body
```

观察第一个窗口中出现的错误信息。

### 方法 3: 检查日志文件（如果有）

```powershell
# 查找最新的日志文件
Get-ChildItem F:\redame\demo -Recurse -Filter "*.log" | Sort-Object LastWriteTime -Descending | Select-Object -First 5
```

## 🔍 常见5001错误原因

### 1. 数据库连接失败
**日志关键字**: `SQLException`, `Connection refused`, `Access denied`

**解决方案**:
- 确认MySQL正在运行
- 检查用户名密码: `root` / `123456`
- 检查数据库名: `motorcycle_service_platform`

### 2. Mapper XML配置错误
**日志关键字**: `BindingException`, `Invalid bound statement`

**解决方案**:
- 检查 `SysUserMapper.xml` 是否在 `src/main/resources/mapper/` 目录下
- 确认XML中的 `namespace` 正确: `com.example.demo.mapper.SysUserMapper`

### 3. 字段映射错误
**日志关键字**: `No setter found`, `Could not set property`

**解决方案**:
- 检查数据库表 `sys_user` 的字段名
- 确认实体类 `SysUser` 的属性名

### 4. 唯一约束冲突（已存在）
**日志关键字**: `Duplicate entry`, `uk_username`, `uk_phone`

**解决方案**:
- 更换用户名或手机号
- 清空测试数据:
  ```sql
  DELETE FROM sys_user WHERE username LIKE 'test%';
  ```

## 🎯 快速测试命令

### 测试数据库连接
```powershell
mysql -uroot -p123456 -e "SELECT COUNT(*) FROM motorcycle_service_platform.sys_user;"
```

### 测试注册接口
```powershell
$body = @{
    username = "quicktest" + (Get-Random -Maximum 9999)
    password = "Test123456"
    confirmPassword = "Test123456"
    phone = "139" + (Get-Random -Minimum 10000000 -Maximum 99999999)
    userType = 1
    code = "test"
} | ConvertTo-Json

Invoke-RestMethod -Uri "http://localhost:8080/auth/register" `
    -Method Post `
    -ContentType "application/json" `
    -Body $body
```

### 测试登录接口（使用admin账号）
```powershell
$body = '{"username":"admin","password":"admin123","userType":3}'
Invoke-RestMethod -Uri "http://localhost:8080/auth/login" `
    -Method Post `
    -ContentType "application/json" `
    -Body $body
```

## 📝 下一步操作

1. **查看后端日志** - 找到具体的错误堆栈
2. **复制错误信息** - 将完整的错误信息复制下来
3. **提供给我** - 我可以根据具体错误提供精准的解决方案

---

**提示**: 5001错误是通用的"系统错误"代码，真正的错误信息在后端日志中。查看日志是解决问题的关键！















