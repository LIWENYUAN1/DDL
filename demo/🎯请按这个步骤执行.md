# ğŸ¯ è¯·æŒ‰è¿™ä¸ªæ­¥éª¤æ‰§è¡Œ

## ğŸ“Œ MySQLé”™è¯¯å·²è§£å†³

æ‚¨çš„é”™è¯¯æ˜¯ï¼š`Unknown column 'contact_person'`

**åŸå› **ï¼šæ‚¨çš„merchantè¡¨å­—æ®µæ˜¯ `contact_name`ï¼ˆä¸æ˜¯ contact_personï¼‰

æˆ‘å·²ç»å‡†å¤‡å¥½äº†æ­£ç¡®çš„SQLï¼

---

## âœ… æ­¥éª¤1ï¼šåœ¨MySQLä¸­æ‰§è¡ŒSQL

### æ–¹æ³•1ï¼šä½¿ç”¨SQLæ–‡ä»¶ï¼ˆæ¨èï¼‰

1. æ‰“å¼€MySQL Workbench
2. ç‚¹å‡» File -> Open SQL Script
3. é€‰æ‹©æ–‡ä»¶ï¼š`F:\redame\demo\æœ€ç®€å•çš„SQL-ç›´æ¥æ‰§è¡Œ.sql`
4. ç‚¹å‡»é—ªç”µå›¾æ ‡âš¡æ‰§è¡Œ
5. æŸ¥çœ‹ç»“æœï¼Œåº”è¯¥æ˜¾ç¤ºå•†å®¶å’ŒæœåŠ¡é¡¹ç›®æ•°æ®

### æ–¹æ³•2ï¼šç›´æ¥å¤åˆ¶ç²˜è´´

åœ¨MySQLä¸­å¤åˆ¶æ‰§è¡Œä»¥ä¸‹SQLï¼š

```sql
USE motorcycle_service_platform;

-- æ’å…¥å•†å®¶ç”¨æˆ·
INSERT INTO sys_user (username, password, phone, user_type, status, create_time, update_time)
SELECT 'merchant_test', '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z2EE4lb8Qrx7hQo3DqsFy2/u', '13900000001', 2, 1, NOW(), NOW()
FROM DUAL
WHERE NOT EXISTS (SELECT 1 FROM sys_user WHERE username = 'merchant_test');

-- æ’å…¥å•†å®¶æ•°æ®
INSERT INTO merchant (
    merchant_name, user_id, contact_name, contact_phone, address, 
    latitude, longitude, location, business_hours, merchant_type, status
)
SELECT 
    'æµ‹è¯•æ‘©æ‰˜ç»´ä¿®åº—',
    (SELECT MIN(id) FROM sys_user WHERE user_type = 2 LIMIT 1),
    'å¼ å¸ˆå‚…',
    '13900139000',
    'åŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½è·¯88å·',
    39.904200, 116.407396,
    ST_GeomFromText('POINT(116.407396 39.904200)'),
    '09:00-20:00', 1, 1
FROM DUAL
WHERE NOT EXISTS (SELECT 1 FROM merchant WHERE merchant_name = 'æµ‹è¯•æ‘©æ‰˜ç»´ä¿®åº—');

-- æ’å…¥æœåŠ¡é¡¹ç›®
INSERT INTO service_item (item_name, description, price, status, create_time, update_time)
SELECT 'å¸¸è§„ä¿å…»', 'æ›´æ¢æœºæ²¹æœºæ»¤ç­‰', 200.00, 1, NOW(), NOW()
FROM DUAL
WHERE NOT EXISTS (SELECT 1 FROM service_item WHERE item_name = 'å¸¸è§„ä¿å…»');

INSERT INTO service_item (item_name, description, price, status, create_time, update_time)
SELECT 'åˆ¹è½¦ç»´æŠ¤', 'æ›´æ¢åˆ¹è½¦ç‰‡åˆ¹è½¦æ²¹', 300.00, 1, NOW(), NOW()
FROM DUAL
WHERE NOT EXISTS (SELECT 1 FROM service_item WHERE item_name = 'åˆ¹è½¦ç»´æŠ¤');

-- éªŒè¯æ•°æ®
SELECT * FROM merchant;
SELECT * FROM service_item;
```

### âœ… æˆåŠŸæ ‡å¿—

æ‰§è¡ŒæˆåŠŸååº”è¯¥çœ‹åˆ°ï¼š
- merchantè¡¨æœ‰æ•°æ®ï¼ˆè‡³å°‘1æ¡ï¼‰
- service_itemè¡¨æœ‰æ•°æ®ï¼ˆè‡³å°‘2æ¡ï¼‰

---

## âœ… æ­¥éª¤2ï¼šå¯åŠ¨åç«¯

åœ¨PowerShellä¸­æ‰§è¡Œï¼š

```powershell
cd F:\redame\demo

# åœæ­¢æ—§è¿›ç¨‹
Get-Process -Name "java" -ErrorAction SilentlyContinue | Stop-Process -Force

# å¯åŠ¨åç«¯
.\mvnw.cmd spring-boot:run
```

**ç­‰å¾…çœ‹åˆ°è¿™è¡Œ**ï¼š
```
Started DemoApplication in X.XXX seconds
```

---

## âœ… æ­¥éª¤3ï¼šæµ‹è¯•åŠŸèƒ½

**æ‰“å¼€æ–°çš„PowerShellçª—å£**ï¼Œæ‰§è¡Œï¼š

```powershell
cd F:\redame\demo
.\test-register-and-appointment.ps1
```

### ğŸ‰ æˆåŠŸæ ‡å¿—

åº”è¯¥çœ‹åˆ°ï¼š

```
[SUCCESS] Register successful!
[SUCCESS] Login successful!
[SUCCESS] Appointment created!
Appointment ID: 1 (æˆ–å…¶ä»–æ•°å­—)

ALL TESTS PASSED!
```

---

## âŒ å¦‚æœæ­¥éª¤1æ‰§è¡ŒSQLæ—¶ä»æœ‰é”™è¯¯

### æƒ…å†µ1ï¼šå¤–é”®çº¦æŸé”™è¯¯

å¦‚æœæç¤º `Cannot add or update a child row`ï¼š

**ä¸´æ—¶è§£å†³**ï¼ˆæ‰§è¡ŒSQLå‰å…ˆè¿è¡Œï¼‰ï¼š
```sql
SET FOREIGN_KEY_CHECKS=0;
-- ç„¶åæ‰§è¡Œæ’å…¥SQL
SET FOREIGN_KEY_CHECKS=1;
```

### æƒ…å†µ2ï¼šåœ°ç†ä½ç½®å­—æ®µé”™è¯¯

å¦‚æœæç¤º `location` å­—æ®µé”™è¯¯ï¼š

**ç®€åŒ–ç‰ˆSQL**ï¼ˆä¸ä½¿ç”¨åœ°ç†ä½ç½®ï¼‰ï¼š

å…ˆåœ¨MySQLä¸­æ‰§è¡Œï¼š
```sql
-- ä¸´æ—¶ä¿®æ”¹merchantè¡¨ï¼Œå…è®¸locationä¸ºç©º
ALTER TABLE merchant MODIFY COLUMN location POINT NULL;
ALTER TABLE merchant MODIFY COLUMN latitude DECIMAL(10,6) NULL;
ALTER TABLE merchant MODIFY COLUMN longitude DECIMAL(10,6) NULL;
```

ç„¶åä½¿ç”¨ç®€åŒ–çš„æ’å…¥SQLï¼š
```sql
INSERT INTO merchant (merchant_name, user_id, contact_name, contact_phone, address, business_hours, merchant_type, status)
VALUES ('æµ‹è¯•æ‘©æ‰˜ç»´ä¿®åº—', 1, 'å¼ å¸ˆå‚…', '13900139000', 'åŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½è·¯88å·', '09:00-20:00', 1, 1)
ON DUPLICATE KEY UPDATE merchant_name=VALUES(merchant_name);
```

### æƒ…å†µ3ï¼šuser_idä¸å­˜åœ¨

æŸ¥çœ‹sys_userè¡¨ä¸­æ˜¯å¦æœ‰user_type=2çš„ç”¨æˆ·ï¼š
```sql
SELECT id, username, user_type FROM sys_user WHERE user_type = 2;
```

å¦‚æœæ²¡æœ‰ï¼Œå…ˆåˆ›å»ºï¼š
```sql
INSERT INTO sys_user (username, password, phone, user_type, status)
VALUES ('merchant_test', '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z2EE4lb8Qrx7hQo3DqsFy2/u', '13900000001', 2, 1);
```

---

## ğŸ’¡ å¿«é€Ÿæ£€æŸ¥å‘½ä»¤

### æ£€æŸ¥merchantè¡¨æ•°æ®
```sql
SELECT id, merchant_name, contact_name FROM merchant;
```

### æ£€æŸ¥service_itemè¡¨æ•°æ®
```sql
SELECT id, item_name, price FROM service_item;
```

---

## ğŸ“ å¦‚æœé—®é¢˜ä»æœªè§£å†³

è¯·æä¾›ï¼š
1. **SQLæ‰§è¡Œçš„å®Œæ•´é”™è¯¯æˆªå›¾**
2. **merchantè¡¨çš„ç»“æ„**ï¼š
   ```sql
   SHOW CREATE TABLE merchant;
   ```
3. **sys_userè¡¨çš„æ•°æ®**ï¼š
   ```sql
   SELECT id, username, user_type FROM sys_user LIMIT 5;
   ```

---

**ç°åœ¨å°±å¼€å§‹æ‰§è¡Œæ­¥éª¤1ï¼** ğŸš€




