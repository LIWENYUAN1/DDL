# ⚡ 快速修复 - 执行这个

## 🔴 问题原因

您的merchant表字段和我之前的SQL不匹配！

**实际字段是**：`contact_name`（不是 contact_person）

## ✅ 正确的SQL（请复制执行）

**在MySQL中执行以下完整SQL**：

```sql
USE motorcycle_service_platform;

-- 1. 先创建商家用户（merchant需要关联user_id）
INSERT INTO sys_user (username, password, phone, user_type, status, create_time, update_time)
VALUES ('merchant_test', '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z2EE4lb8Qrx7hQo3DqsFy2/u', '13900000001', 2, 1, NOW(), NOW())
ON DUPLICATE KEY UPDATE username=VALUES(username);

-- 2. 获取商家用户ID
SET @merchant_user_id = (SELECT id FROM sys_user WHERE username = 'merchant_test' LIMIT 1);

-- 3. 插入商家数据（使用正确的字段名）
INSERT INTO merchant (
    id, merchant_name, user_id, contact_name, contact_phone, address, 
    latitude, longitude, location, business_hours, merchant_type, 
    status, create_time, update_time
)
VALUES (
    1, '测试摩托维修店', @merchant_user_id, '张师傅', '13900139000', 
    '北京市朝阳区建国路88号', 39.904200, 116.407396, 
    ST_GeomFromText('POINT(116.407396 39.904200)'), '09:00-20:00', 1, 
    1, NOW(), NOW()
)
ON DUPLICATE KEY UPDATE merchant_name=VALUES(merchant_name), update_time=NOW();

-- 4. 插入服务项目
INSERT INTO service_item (id, item_name, description, price, status, create_time, update_time)
VALUES 
(1, '常规保养', '更换机油、机滤等', 200.00, 1, NOW(), NOW()),
(2, '刹车维护', '更换刹车片刹车油', 300.00, 1, NOW(), NOW())
ON DUPLICATE KEY UPDATE item_name=VALUES(item_name), update_time=NOW();

-- 5. 验证数据
SELECT '商家数据：' as info, COUNT(*) as count FROM merchant;
SELECT '服务项目：' as info, COUNT(*) as count FROM service_item;
SELECT * FROM merchant WHERE id = 1;
SELECT * FROM service_item WHERE id IN (1,2);
```

## 📝 预期结果

执行成功后应该看到：
- ✅ merchant表有1条记录
- ✅ service_item表有2条记录
- ✅ 显示详细的商家和服务项目信息

## 🚀 执行SQL后的下一步

### 1. 启动后端

```powershell
cd F:\redame\demo
Get-Process -Name "java" -ErrorAction SilentlyContinue | Stop-Process -Force
.\mvnw.cmd spring-boot:run
```

**等待看到**：`Started DemoApplication`

### 2. 测试功能（新窗口）

```powershell
cd F:\redame\demo
.\test-register-and-appointment.ps1
```

**预期输出**：
```
[SUCCESS] Register successful!
[SUCCESS] Login successful!
[SUCCESS] Appointment created!
Appointment ID: 1
```

## ❓ 如果SQL执行仍然失败

请截图完整的错误信息告诉我，可能需要检查：
1. merchant表的完整结构
2. sys_user表是否存在
3. 外键约束是否正常

## 📂 完整SQL文件

也可以直接在MySQL中打开执行这个文件：
```
F:\redame\demo\正确的测试数据.sql
```

---

**现在就执行上面的SQL！** 🎯




